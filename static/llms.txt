# SkillGuard: SSL for Agent Skills
> Verifiable AI skill safety classification with zero-knowledge ML proofs

## What this API does
SkillGuard classifies AI agent skills as SAFE, CAUTION, DANGEROUS, or MALICIOUS.
Every classification includes a mandatory cryptographic zkML proof (SNARK via Jolt/Dory)
that anyone can verify independently. Think of it as an SSL certificate for agent skills:
the proof guarantees the classification was computed correctly by the neural network.

## Base URL
https://skillguard.onrender.com

## Authentication
- x402 payment: $0.001 USDC on Base per classification (no API key needed)
- Or: Bearer token via Authorization header

## Endpoints

### Classify a skill (paid)
POST /api/v1/evaluate
Content-Type: application/json

By name (looks up skill on ClawHub):
{"skill": "skill-slug-name"}

With full data:
{"skill": {"name": "my-skill", "version": "1.0.0", "author": "alice", "description": "A skill", "skill_md": "# My Skill\nDoes something useful.", "scripts": [], "files": []}}

Response includes: classification, decision, confidence, class scores, reasoning, and a zkML proof bundle.

### Verify a proof (free, no auth)
POST /api/v1/verify
Content-Type: application/json
{"proof_b64": "...", "program_io": {...}}

Returns: {"valid": true, "verification_time_ms": 74}

### Health check (free)
GET /health

### Usage statistics (free)
GET /stats

### OpenAPI spec
GET /openapi.json

### Agent discovery manifest
GET /.well-known/ai-plugin.json

## Pricing
$0.001 USDC per classification on Base (EIP-155 chain 8453).
Payment via x402 protocol (HTTP 402 flow with ERC-3009 TransferWithAuthorization).
Verification is always free.

## Example: one-shot classify
curl -X POST https://skillguard.onrender.com/api/v1/evaluate \
  -H "Content-Type: application/json" \
  -d '{"skill": "4claw"}'

## Model
3-layer MLP: 35 inputs → 56 hidden (ReLU) → 40 hidden (ReLU) → 4 outputs.
4,460 parameters. Fixed-point i32 arithmetic (scale=7, rounding division).
QAT-trained with FGSM adversarial examples on 690 samples (incl. unknown-metadata augmentation).
93.9% cross-validated accuracy. Softmax temperature T=12.8 (fixed-point).
~53 KB proofs, ~4s proving time.

Per-class metrics (5-fold CV mean):
  SAFE:      P=91.5% R=96.9% F1=94.1%
  CAUTION:   P=93.2% R=90.6% F1=91.8%
  DANGEROUS: P=94.8% R=95.3% F1=94.9%
  MALICIOUS: P=98.0% R=92.7% F1=95.2%

The model extracts 35 numeric features from each skill (shell exec counts, network calls,
obfuscation score, reverse shell patterns, credential access, author reputation, download
counts, byte entropy, density ratios, interaction terms). When a skill has no separate
scripts, code blocks inside SKILL.md are extracted and analyzed. Features are scaled to
0-128 and fed through the network. The highest of the 4 output scores (SAFE, CAUTION,
DANGEROUS, MALICIOUS) determines the classification. Confidence is the softmax probability
of the top class. High-entropy (uncertain) predictions are flagged for human review.

## Links
- OpenAPI spec: https://skillguard.onrender.com/openapi.json
- Agent plugin manifest: https://skillguard.onrender.com/.well-known/ai-plugin.json
- GitHub: https://github.com/hshadab/skillguard
- x402 protocol: https://www.x402.org/
