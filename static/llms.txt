# SkillGuard: SSL for Agent Skills
> Verifiable AI skill safety classification with zero-knowledge ML proofs

## What this API does
SkillGuard classifies AI agent skills as SAFE, CAUTION, or DANGEROUS.
Every classification includes a mandatory cryptographic zkML proof (SNARK via Jolt/Dory)
that anyone can verify independently. Think of it as an SSL certificate for agent skills:
the proof guarantees the classification was computed correctly by the neural network.

## Base URL
https://skillguard.onrender.com

## Authentication
- x402 payment: $0.001 USDC on Base per classification (no API key needed)
- Or: Bearer token via Authorization header

## Endpoints

### Classify a skill (paid)
POST /api/v1/evaluate
Content-Type: application/json

By name (looks up skill on ClawHub):
{"skill": "skill-slug-name"}

With full data:
{"skill": {"name": "my-skill", "version": "1.0.0", "author": "alice", "description": "A skill", "skill_md": "# My Skill\nDoes something useful.", "scripts": [], "files": []}}

Response includes: classification, decision, confidence, class scores, reasoning, and a zkML proof bundle.

### Verify a proof (free, no auth)
POST /api/v1/verify
Content-Type: application/json
{"proof_b64": "...", "program_io": {...}}

Returns: {"valid": true, "verification_time_ms": 74}

### Catalog lookup (free, no auth, instant)
GET /api/v1/catalog/{skill_name}

Returns cached classification data for a previously evaluated skill without re-running
the model or generating a new proof. Instant response, no authentication required.

Example: GET /api/v1/catalog/4claw
Returns: {"success": true, "entry": {"skill_name": "4claw", "classification": "SAFE", "decision": "ALLOW", "confidence": 0.97, "scores": {...}, "model_version": "...", "evaluated_at": "..."}}

Returns 404 if the skill has not been evaluated before.

### Health check (free)
GET /health

### Usage statistics (free)
GET /stats

### OpenAPI spec
GET /openapi.json

### Agent discovery manifest
GET /.well-known/ai-plugin.json

## Pricing
$0.001 USDC per classification on Base (EIP-155 chain 8453).
Payment via x402 protocol (HTTP 402 flow with ERC-3009 TransferWithAuthorization).
Verification is always free.

## Example: one-shot classify
curl -X POST https://skillguard.onrender.com/api/v1/evaluate \
  -H "Content-Type: application/json" \
  -d '{"skill": "4claw"}'

## Model (v2.0, v3.0 training pipeline in progress)
3-layer MLP: 35 inputs → 56 hidden (ReLU) → 40 hidden (ReLU) → 3 outputs.
4,419 parameters. Fixed-point i32 arithmetic (scale=7, rounding division).
QAT-trained with exact i32 integer-division simulation + FGSM adversarial examples.
Softmax temperature T=0.95 on integer-scale logits (ECE=0.045).
~53 KB proofs, ~4s proving time.

v2.0 (current): 425 LLM-labeled real OpenClaw skills + 106 augmented samples.
  CV accuracy: 68%. DANGEROUS F1: 0.80. SAFE F1: 0.585. CAUTION F1: 0.697.
v3.0 (target): 1,400+ real skills with improved labeling, 15% held-out test set.
  Target: ≥80% CV accuracy, ≥0.82 DANGEROUS F1, ≥0.75 SAFE F1, ≥78% holdout accuracy.

The v3.0 training pipeline scales data through phased collection:
1. DANGEROUS-priority labeling (--prioritize-dangerous) to fix class imbalance
2. Improved LLM prompt with explicit SAFE/CAUTION boundary rules and few-shot examples
3. SAFE/CAUTION boundary enrichment (--prioritize-boundary) targeting model-confused skills
4. Stratified diversity sampling across categories and confidence bands
5. Human review queue prioritizing DANGEROUS labels and MLP/LLM disagreements

The model extracts 35 numeric features from each skill (shell exec counts, network calls,
obfuscation score, reverse shell patterns, credential access, author reputation, download
counts, byte entropy, density ratios, interaction terms). When a skill has no separate
scripts, code blocks inside SKILL.md are extracted and analyzed. Features are scaled to
0-128 and fed through the network. The highest of the 3 output scores (SAFE, CAUTION,
DANGEROUS) determines the classification. Confidence is the softmax probability
of the top class. High-entropy (uncertain, >0.67 normalized) predictions are flagged for review.

## Model versioning
Every evaluation response includes a model_version field containing the SHA-256 hash
of the model bytecode used for that classification. Catalog entries also include the
model_version so you can tell whether a cached result was produced by the current model
or an older one. Check /health for the active model_hash.

## Links
- OpenAPI spec: https://skillguard.onrender.com/openapi.json
- Agent plugin manifest: https://skillguard.onrender.com/.well-known/ai-plugin.json
- GitHub: https://github.com/hshadab/skillguard
- x402 protocol: https://www.x402.org/
